{% extends "gym/layout.html" %}
{% load static %}

{% block title %}User Profile - RoshaClub{% endblock %}

{% block content %}

<div class="profile-page-shell">

  <div class="profile-page-inner">

    {# HERO #}
    <section class="profile-hero">
      <div class="profile-hero__row">
        <div class="profile-hero__content">
          <div class="profile-badge">
            <span class="profile-badge__dot"></span>
            Profile • Progress • Membership
          </div>

          <h1 class="profile-hero__title">
            Welcome, <span class="profile-gold">{{ user.username }}</span>
          </h1>

          <p class="profile-hero__text">
            Here are your personal details and current membership status.
          </p>
        </div>

        <div class="profile-hero__actions">
          <a href="{% url 'edit_profile' %}" class="btn price__btn profile-btn-secondary" style="text-decoration:none;">
            Edit Profile
          </a>
          <a href="{% url 'training_programs' %}" class="btn btn-primary profile-btn-primary" style="text-decoration:none;">
            Browse Programs
          </a>
        </div>
      </div>
    </section>

    {# MAIN CARD #}
    <section class="profile-main-card">
      <div class="profile-main-card__head">
        <div>
          <div class="profile-main-card__title">Account Overview</div>
          <div class="profile-main-card__sub">Clean summary. No fluff.</div>
        </div>

        <div>
          {% if membership %}
            <span class="profile-status-badge profile-status-badge--active">
              <span class="profile-status-badge__dot profile-status-badge__dot--active"></span>
              Active membership
            </span>
          {% else %}
            <span class="profile-status-badge profile-status-badge--inactive">
              <span class="profile-status-badge__dot profile-status-badge__dot--inactive"></span>
              No active membership
            </span>
          {% endif %}
        </div>
      </div>

      <div class="profile-main-card__body">

        {# grid of info cards #}
        <div class="profile-info-grid">

          {# Name #}
          <div class="profile-info-card">
            <div class="profile-info-card__label">Name</div>
            <div class="profile-info-card__value">
              {% if user.first_name or user.last_name %}
                {{ user.first_name }} {{ user.last_name }}
              {% else %}
                —
              {% endif %}
            </div>
          </div>

          {# Email #}
          <div class="profile-info-card">
            <div class="profile-info-card__label">Email</div>
            <div class="profile-info-card__value">
              {{ user.email|default:"—" }}
            </div>
          </div>

          {% if membership %}

            {# Plan #}
            <div class="profile-info-card">
              <div class="profile-info-card__label">Membership Plan</div>
              <div class="profile-info-card__value profile-info-card__value--gold">
                {{ membership.program.name }}
              </div>
            </div>

            {# Status #}
            <div class="profile-info-card">
              <div class="profile-info-card__label">Status</div>
              <div class="profile-info-card__value">
                {{ membership.get_status_display }}
              </div>
            </div>

            {# Dates #}
            <div class="profile-info-card">
              <div class="profile-info-card__label">Start Date</div>
              <div class="profile-info-card__value profile-info-card__value--date">
                {{ membership.start_date|date:"F d, Y" }}
              </div>
            </div>

            <div class="profile-info-card">
              <div class="profile-info-card__label">End Date</div>
              <div class="profile-info-card__value profile-info-card__value--date">
                {{ membership.end_date|date:"F d, Y" }}
              </div>
            </div>

            {# Trainer block #}
            <div class="profile-coach-card">
              <div class="profile-coach-card__top">
                <div>
                  <div class="profile-coach-card__title">Your Coach</div>
                  <div class="profile-coach-card__sub">The one who makes sure you don’t stay average.</div>
                </div>

                {% if trainer %}
                  <a href="{% url 'trainer_detail' trainer.id %}" class="btn btn-primary profile-coach-card__btn" style="text-decoration:none;">
                    View Trainer
                  </a>
                {% endif %}
              </div>

              {% if trainer %}
                <div class="profile-coach-layout">
                  <div class="profile-coach-photo-wrap">
                    {% if trainer.get_photo %}
                      <img src="{{ trainer.get_photo }}" alt="Trainer Photo" class="profile-coach-photo">
                    {% else %}
                      <div class="profile-coach-photo-empty">No photo</div>
                    {% endif %}
                  </div>

                  <div class="profile-coach-info">
                    <div class="profile-coach-name">
                      {{ trainer.name }}
                    </div>
                    <div class="profile-coach-description">
                      {{ trainer.description }}
                    </div>
                  </div>
                </div>
              {% else %}
                <div class="profile-coach-warning">
                  No trainer assigned to this program yet.
                </div>
              {% endif %}
            </div>

          {% else %}

            {# No membership CTA #}
            <div class="profile-empty-membership">
              <div class="profile-empty-membership__title">Membership</div>
              <div class="profile-empty-membership__text">
                You don't have an active membership. Pick a program and start your grind.
              </div>

              <div class="profile-empty-membership__actions">
                <a href="{% url 'training_programs' %}" class="btn btn-primary profile-empty-membership__btn" style="text-decoration:none;">
                  Choose a program
                </a>
                <a href="{% url 'community' %}" class="btn price__btn profile-empty-membership__btn" style="text-decoration:none;">
                  Check community
                </a>
              </div>
            </div>

          {% endif %}

        </div>

      </div>
    </section>

  </div>
</div>

<style>
  .profile-page-shell{
    background:
      radial-gradient(1200px 520px at 20% 20%, rgba(255,215,0,.12), transparent 60%),
      radial-gradient(900px 420px at 85% 35%, rgba(249,172,84,.14), transparent 55%),
      linear-gradient(180deg, rgba(12,12,14,.94), rgba(7,7,9,.96));
    min-height: 100vh;
    padding: 4.2rem 1rem 3rem;
  }

  .profile-page-inner{
    max-width: 1100px;
    margin: 0 auto;
  }

  .profile-gold{
    color:#FFD700;
  }

  .profile-hero{
    margin-bottom: 1.4rem;
  }

  .profile-hero__row{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap: 1.2rem;
    flex-wrap:wrap;
  }

  .profile-hero__content{
    max-width: 760px;
  }

  .profile-badge{
    display:inline-flex;
    align-items:center;
    gap:.6rem;
    padding:.45rem .8rem;
    border-radius:999px;
    border:1px solid rgba(255,215,0,.22);
    background:rgba(0,0,0,.22);
    color:rgba(255,215,0,.95);
    font-weight:800;
    letter-spacing:.3px;
    margin-bottom: 1.1rem;
  }

  .profile-badge__dot{
    width:8px;
    height:8px;
    border-radius:50%;
    background:rgba(255,215,0,.95);
    display:inline-block;
  }

  .profile-hero__title{
    margin:0;
    color:#fff;
    font-weight: 900;
    font-size: 2.6rem;
    line-height:1.1;
  }

  .profile-hero__text{
    margin:.65rem 0 0;
    color: rgba(255,255,255,.74);
    line-height: 1.75;
    font-size: 1.02rem;
    max-width: 700px;
  }

  .profile-hero__actions{
    display:flex;
    gap:10px;
    align-items:center;
    flex-wrap:wrap;
  }

  .profile-btn-primary,
  .profile-btn-secondary{
    border-radius: 14px;
    font-weight: 900;
  }

  .profile-main-card{
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
    box-shadow: 0 18px 40px rgba(0,0,0,.35);
    overflow: hidden;
  }

  .profile-main-card__head{
    padding: 1.2rem 1.4rem;
    border-bottom: 1px solid rgba(255,255,255,.08);
    display:flex;
    justify-content:space-between;
    gap: 12px;
    flex-wrap:wrap;
  }

  .profile-main-card__title{
    color:#fff;
    font-weight:900;
    font-size:1.2rem;
    margin-bottom: .18rem;
  }

  .profile-main-card__sub{
    color:rgba(255,255,255,.70);
  }

  .profile-main-card__body{
    padding: 1.4rem;
  }

  .profile-status-badge{
    display:inline-flex;
    align-items:center;
    gap:.5rem;
    padding:.55rem .9rem;
    border-radius:999px;
    color: rgba(255,255,255,.92);
    font-weight:900;
  }

  .profile-status-badge--active{
    border:1px solid rgba(34,197,94,.25);
    background: rgba(34,197,94,.10);
  }

  .profile-status-badge--inactive{
    border:1px solid rgba(245,158,11,.25);
    background: rgba(245,158,11,.10);
  }

  .profile-status-badge__dot{
    width:8px;
    height:8px;
    border-radius:50%;
    display:inline-block;
  }

  .profile-status-badge__dot--active{
    background:#22c55e;
  }

  .profile-status-badge__dot--inactive{
    background:#f59e0b;
  }

  .profile-info-grid{
    display:grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 12px;
  }

  .profile-info-card{
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.18);
    padding: 1rem 1rem;
    min-width: 0;
  }

  .profile-info-card__label{
    color: rgba(255,255,255,.65);
    font-weight:800;
    margin-bottom:6px;
  }

  .profile-info-card__value{
    color:#fff;
    font-weight:900;
    font-size:1.1rem;
    word-break: break-word;
  }

  .profile-info-card__value--gold{
    color:#FFD700;
    font-size:1.15rem;
  }

  .profile-info-card__value--date{
    font-size:1.05rem;
  }

  .profile-coach-card{
    grid-column: 1 / -1;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.03);
    padding: 1.2rem 1.2rem;
    margin-top: 6px;
  }

  .profile-coach-card__top{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap: 12px;
    flex-wrap:wrap;
  }

  .profile-coach-card__title{
    color:#fff;
    font-weight:900;
    font-size:1.2rem;
    margin-bottom: .18rem;
  }

  .profile-coach-card__sub{
    color:rgba(255,255,255,.70);
    line-height: 1.6;
  }

  .profile-coach-card__btn{
    border-radius:14px;
    font-weight:900;
  }

  .profile-coach-layout{
    margin-top: 12px;
    display:grid;
    grid-template-columns: 160px 1fr;
    gap: 14px;
    align-items: start;
  }

  .profile-coach-photo-wrap{
    width: 160px;
    height: 160px;
    border-radius: 18px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.18);
    overflow:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .profile-coach-photo{
    width:100%;
    height:100%;
    object-fit:cover;
    display:block;
  }

  .profile-coach-photo-empty{
    color: rgba(255,255,255,.75);
    font-weight:900;
  }

  .profile-coach-info{
    border-radius: 16px;
    border: 1px solid rgba(255,255,255,.10);
    background: rgba(0,0,0,.18);
    padding: 1rem 1rem;
    min-width: 0;
  }

  .profile-coach-name{
    color:#FFD700;
    font-weight:900;
    font-size:1.25rem;
    margin-bottom:6px;
  }

  .profile-coach-description{
    color: rgba(255,255,255,.85);
    line-height:1.75;
  }

  .profile-coach-warning{
    margin-top: 12px;
    border-radius: 16px;
    border: 1px solid rgba(245,158,11,.25);
    background: rgba(245,158,11,.10);
    color: rgba(255,255,255,.92);
    padding: 12px 14px;
    line-height:1.6;
    font-weight:700;
  }

  .profile-empty-membership{
    grid-column: 1 / -1;
    border-radius: 18px;
    border: 1px solid rgba(245,158,11,.25);
    background: rgba(245,158,11,.10);
    padding: 1.2rem 1.2rem;
    line-height:1.7;
    color: rgba(255,255,255,.92);
  }

  .profile-empty-membership__title{
    font-weight:900;
    font-size:1.1rem;
    margin-bottom:6px;
  }

  .profile-empty-membership__text{
    color: rgba(255,255,255,.85);
  }

  .profile-empty-membership__actions{
    margin-top: 12px;
    display:flex;
    gap: 10px;
    flex-wrap:wrap;
  }

  .profile-empty-membership__btn{
    border-radius:14px;
    font-weight:900;
  }

  /* ===== Tablet ===== */
  @media (max-width: 980px){
    .profile-page-shell{
      padding: 3.5rem 1rem 2.5rem;
    }

    .profile-hero__title{
      font-size: 2.2rem;
    }

    .profile-info-grid{
      grid-template-columns: 1fr;
    }

    .profile-coach-layout{
      grid-template-columns: 140px 1fr;
    }

    .profile-coach-photo-wrap{
      width: 140px;
      height: 140px;
    }
  }

  /* ===== Mobile ===== */
  @media (max-width: 768px){
    .profile-page-shell{
      padding: 3rem 1rem 2rem;
    }

    .profile-badge{
      font-size: .84rem;
      padding: .42rem .72rem;
      margin-bottom: .95rem;
    }

    .profile-hero{
      margin-bottom: 1.15rem;
    }

    .profile-hero__title{
      font-size: 2rem;
      line-height: 1.08;
      letter-spacing: -.02em;
    }

    .profile-hero__text{
      font-size: .98rem;
      line-height: 1.72;
      margin-top: .6rem;
    }

    .profile-hero__actions{
      width: 100%;
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
    }

    .profile-hero__actions .btn{
      width: 100%;
      text-align: center;
      justify-content: center;
    }

    .profile-main-card__head{
      padding: 1rem 1rem;
    }

    .profile-main-card__body{
      padding: 1rem;
    }

    .profile-status-badge{
      width: 100%;
      justify-content: center;
      text-align: center;
    }

    .profile-info-card{
      padding: .95rem .95rem;
    }

    .profile-info-card__value{
      font-size: 1rem;
    }

    .profile-info-card__value--gold{
      font-size: 1.05rem;
    }

    .profile-coach-card{
      padding: 1rem;
    }

    .profile-coach-card__btn{
      width: 100%;
      text-align: center;
      justify-content: center;
    }

    .profile-coach-layout{
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .profile-coach-photo-wrap{
      width: 100%;
      height: 240px;
      max-width: 320px;
      margin: 0 auto;
    }

    .profile-coach-info{
      padding: .95rem .95rem;
    }

    .profile-coach-name{
      font-size: 1.1rem;
    }

    .profile-coach-description{
      font-size: .95rem;
      line-height: 1.68;
    }

    .profile-empty-membership{
      padding: 1rem;
    }

    .profile-empty-membership__actions{
      flex-direction: column;
      align-items: stretch;
    }

    .profile-empty-membership__actions .btn{
      width: 100%;
      text-align: center;
      justify-content: center;
    }
  }

  /* ===== Small phones ===== */
  @media (max-width: 480px){
    .profile-page-shell{
      padding: 2.7rem .85rem 1.8rem;
    }

    .profile-hero__title{
      font-size: 1.72rem;
    }

    .profile-hero__text{
      font-size: .94rem;
    }

    .profile-main-card__title{
      font-size: 1.08rem;
    }

    .profile-main-card__sub{
      font-size: .92rem;
    }

    .profile-status-badge{
      padding: .52rem .8rem;
      font-size: .92rem;
    }

    .profile-info-card__label{
      font-size: .9rem;
    }

    .profile-info-card__value,
    .profile-info-card__value--date{
      font-size: .96rem;
    }

    .profile-info-card__value--gold{
      font-size: 1rem;
    }

    .profile-coach-photo-wrap{
      height: 210px;
    }

    .profile-coach-card__title{
      font-size: 1.06rem;
    }

    .profile-coach-card__sub{
      font-size: .92rem;
    }

    .profile-coach-description{
      font-size: .92rem;
    }

    .profile-empty-membership__title{
      font-size: 1rem;
    }

    .profile-empty-membership__text{
      font-size: .92rem;
    }
  }
</style>

{% endblock %}